<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="./assets/css/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
  <title>Room Editor</title>
</head>
<body>
  <div class="header-brand">
    <a href="https://github.com/Elanoran/mud_area_editor" class="branding">
      <img src="assets/images/brand-logo-small.png" alt="Mud Area Editor" class="logo">
    </a>
  </div>
  <div class="editor-wrapper">
    <div id="sidebar">
      <div id="tool-info" class="ui-element">
        <div class="toolbar" style="display: flex; gap: 6px; margin-bottom: 0;flex-direction: initial;">
          <button id="undoBtn" class="ui-element" title="Undo">↺</button>
          <button id="redoBtn" class="ui-element" title="Redo">↻</button>
          <button id="cleanSceneBtn" class="ui-element" title="Clean Scene"><i class="fa-solid fa-broom"></i></button>
          <button id="floorToggleBtn2" style="color: #42425b;text-shadow:none;" class="ui-element" title="Show ground floor"><i class="fa-solid fa-eye-slash"></i></button>
          <button id="fitViewBtn" class="ui-element" title="Lock"><i class="fa-solid fa-lock"></i></button>
          <button id="helpBtn" class="ui-element" title="Help" style="cursor: pointer;">
            <i class="fa-solid fa-info" style="pointer-events: none;"></i>
          </button>
        </div>
        <hr style="width: 100%;border: none; border-top: 1px solid #404059; margin: 0;">
        <div class="tab-row">
          <div class="tab-header" style="flex-grow: 1;">
            <button class="tab-button active" data-tab="gridTab">Grid</button>
            <button class="tab-button" data-tab="areaTab">Area</button>
            <button class="tab-button" data-tab="roomTab">Room</button>
          </div>
        </div>

        <div id="areaInfoContainer">
          <div id="gridTab" class="tab-content active">
            <div class="toolbar" style="display: flex; gap: 6px; margin-bottom: 0;flex-direction: initial;">
              <button id="floorToggleBtn" class="ui-element" title="Show ground floor"><i class="fa-solid fa-eye"></i></button>
              <button id="extraBtn1" style="color: #42425b;text-shadow:none;" class="ui-element" title="Add"><i class="fa-solid fa-plus"></i></button>
              <button id="extraBtn2" style="color: #42425b;text-shadow:none;" class="ui-element" title="Remove"><i class="fa-solid fa-minus"></i></button>
              <button id="extraBtn3" style="color: #42425b;text-shadow:none;" class="ui-element" title="Refresh"><i class="fa-solid fa-sync"></i></button>
              <button id="extraBtn4" style="color: #42425b;text-shadow:none;" class="ui-element" title="Save"><i class="fa-solid fa-save"></i></button>
              <button id="extraBtn5" style="color: #42425b;text-shadow:none;" class="ui-element" title="Download"><i class="fa-solid fa-download"></i></button>
            </div>
            <div class="field-group">
              <div style="display: flex; align-items: center; gap: 10px;margin-top: 5px;">
                <button id="gridToggleBtn" class="ui-element" title="Toggle Grid" style="padding:0 5px; color: #e6ded3;;">
                  <svg height="22" width="22" viewBox="0 0 1920 1920" style="margin-top: 4px;margin-left: -4px;" xmlns="http://www.w3.org/2000/svg" fill="currentColor">
                    <path d="M1740 0c99.24 0 180 80.76 180 180v1560c0 99.24-80.76 180-180 180H180c-99.24 0-180-80.76-180-180V180C0 80.76 80.76 0 180 0h1560ZM894 1800v-774H120v677.25c0 53.213 43.537 96.75 96.75 96.75H894Zm0-906V120H216.75c-53.213 0-96.75 43.537-96.75 96.75V894h774Zm906 809.25V1026h-774v774h677.25c53.213 0 96.75-43.537 96.75-96.75Zm0-809.25V216.75c0-53.213-43.537-96.75-96.75-96.75H1026v774h774Z" fill-rule="evenodd"/>
                  </svg>
                </button>
                <select id="gridSelect" class="full-width"></select>
              </div>
            </div>
            <hr style="border: none; border-top: 1px solid #404059; margin: 10px 0 0;">
            <!-- Add more grid-specific controls here as needed -->
            <div class="field-group" style="margin-top: 10px;">
              <label for="surfaceSelect">Surface Material:<br>
                <select id="surfaceSelect" class="full-width">
                  <option value="grass">Grass</option>
                  <option value="asphalt">Asphalt</option>
                  <option value="fabric">Fabric</option>
                  <option value="blue">Blue</option>
                  <option value="sand">Sand</option>
                  <option value="dirt">Dirt</option>
                  <option value="charcoal">Charcoal</option>
                </select>
              </label>
            </div>
          </div>
          <div id="areaTab" class="tab-content">
            <div class="toolbar" style="display: flex; gap: 6px; margin-bottom: 0;flex-direction: initial;">
              <button id="floorToggleBtn3" class="ui-element" title="Show ground floor"><i class="fa-solid fa-eye-slash"></i></button>
              <button id="extraBtn1" style="color: #42425b;text-shadow:none;" class="ui-element" title="Add"><i class="fa-solid fa-plus"></i></button>
              <button id="extraBtn2" style="color: #42425b;text-shadow:none;" class="ui-element" title="Remove"><i class="fa-solid fa-minus"></i></button>
              <button id="extraBtn3" style="color: #42425b;text-shadow:none;" class="ui-element" title="Refresh"><i class="fa-solid fa-sync"></i></button>
              <button id="extraBtn4" style="color: #42425b;text-shadow:none;" class="ui-element" title="Save"><i class="fa-solid fa-save"></i></button>
              <button id="extraBtn5" style="color: #42425b;text-shadow:none;" class="ui-element" title="Download"><i class="fa-solid fa-download"></i></button>
            </div>
            <div class="field-group" style="margin-top: 10px;">
              <label>Area Name:<br>
                <input type="text" id="areaName" class="full-width">
              </label>
            </div>
            <div class="field-group">
              <label>Filename:<br>
                <div style="display: flex; align-items: center;">
                  <input type="text" id="filename" class="full-width" style="flex: 1;">
                  <span id="filenameExt" style="margin-left: 5px; color: #aaa; min-width: 30px;">.json</span>
                </div>
              </label>
            </div>
            <div class="vnum-row">
              <div class="vnum-field">
                <label>VNUM Min:<br>
                  <input type="number" id="vnumMin" class="full-width">
                </label>
              </div>
              <div class="vnum-field">
                <label>VNUM Max:<br>
                  <input type="number" id="vnumMax" class="full-width">
                </label>
              </div>
            </div>
            <hr style="width: 100%;border: none; border-top: 1px solid #404059; margin: 0;">
            <div class="toolbar" style="display: flex; justify-content: space-between; align-items: center; margin-top: 12px;">
              <div style="display: flex; align-items: center; gap: 6px;">
                <button id="importJsonBtn" class="ui-element" title="Import JSON"><i class="fa-solid fa-upload"></i></button>
                <input type="file" id="importInput" accept=".json" style="display:none">
              </div>
              <div style="display: flex; align-items: center; gap: 6px;">
                <button id="exportFormatBtn" class="ui-element" title="Export As"><i class="fa-solid fa-save"></i></button>
                <select id="exportFormat" class="ui-element" style="flex: 1 1 150px; font-size: 1em; height: 2.4em; margin-bottom: 4px;"></select>
              </div>
            </div>
          </div>
          <div id="roomTab" class="tab-content">
            <div class="toolbar" style="display: flex; flex-direction: initial; gap: 6px;">
              <button id="extraBtn1" style="color: #42425b;text-shadow:none;" class="ui-element" title="Add"><i class="fa-solid fa-plus"></i></button>
              <button id="extraBtn2" style="color: #42425b;text-shadow:none;" class="ui-element" title="Remove"><i class="fa-solid fa-minus"></i></button>
              <button id="extraBtn3" style="color: #42425b;text-shadow:none;" class="ui-element" title="Refresh"><i class="fa-solid fa-sync"></i></button>
              <button id="extraBtn4" style="color: #42425b;text-shadow:none;" class="ui-element" title="Save"><i class="fa-solid fa-save"></i></button>
              <button id="extraBtn5" style="color: #42425b;text-shadow:none;" class="ui-element" title="Download"><i class="fa-solid fa-download"></i></button>
              <button id="deleteRoomBtn" class="ui-element" title="Delete Room"><i class="fa-solid fa-trash"></i></button>
            </div>
            <div class="field-group">
            <label for="roomColorOptions"></label>
            <div id="roomColorOptions" style="display: flex; gap: 6px; flex-wrap: wrap;">
              <button class="room-color-option" data-color="#e74c3c" style="background:#e74c3c;" title="Red"></button>
              <button class="room-color-option" data-color="#f39c12" style="background:#f39c12;" title="Orange"></button>
              <button class="room-color-option" data-color="#f1c40f" style="background:#f1c40f;" title="Yellow"></button>
              <button class="room-color-option" data-color="#2ecc71" style="background:#2ecc71;" title="Green"></button>
              <button class="room-color-option" data-color="#3498db" style="background:#3498db;" title="Blue"></button>
              <button class="room-color-option" data-color="#9b59b6" style="background:#9b59b6;" title="Purple"></button>
              <button class="room-color-option" data-color="#ffffff" style="background:#ffffff; border:1px solid #aaa;" title="White"></button>
              <button class="room-color-option" data-color="#95a5a6" style="background:#95a5a6;" title="Gray"></button>
            </div>
            <hr style="border: none; border-top: 1px solid #404059; margin: 10px 0 0;">
        </div>
            <div class="field-group">
              <label>
                VNUM:
                <span id="roomVnumCoords" style="margin-left: 10px; font-weight: normal; color: #939393;"></span><br>
                <input type="number" id="roomVnum" class="full-width">
              </label>
            </div>
            <div class="field-group">
              <label>Name:<br>
                <input type="text" id="roomName" class="full-width">
              </label>
            </div>
            <div class="field-group">
              <label>Description:<br>
                <textarea id="roomDesc" class="full-width" rows="4"></textarea>
              </label>
            </div>
            <div class="field-group">
              <label>Exits:</label>
              <ul id="roomExitsList" class="full-width"></ul>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div id="levelWheelContainer" class="level-wheel-container">
      <button id="levelWheelUp" class="wheel-arrow">&#9650;</button>
      <div id="levelWheel" class="level-wheel"></div>
      <button id="levelWheelDown" class="wheel-arrow">&#9660;</button>
    </div>
  </div>
  <div id="helpPopup" class="ui-element" style="display:none; position:fixed; top:20%; left:50%; transform:translateX(-50%); background:#333; padding:20px; border:1px solid #888; z-index:1000; color:white;">
    <button id="helpClose" style="position:absolute; top:5px; right:8px; font-size:16px; background:none; border:none; color:white; cursor:pointer;">✕</button>
    <h2>Editor Help</h2>
    <p>Welcome to the Room Editor. Here's what you can do:</p>
    <ul>
      <li>Use the grid to place rooms on different levels.</li>
      <li><span class="key">Shift</span> + <span class="key">Left-click</span> on the grid to add a room. (With no other room selected)</li>
      <li>Mark an existing room and click the delete button in the toolbar to remove it.</li>
      <li><span class="key">click</span> a room to select it for linking.</li>
      <li><span class="key">Shift</span> + <span class="key">Left-click</span> another room to create or remove a directional link between them.</li>
      <li>After a room has been placed you can click the lock button toolbar to freely move a selected rooms.</li>
      <li>Use the inputs on the left to edit room VNUM, name, and description.</li>
      <li>Use the dropdowns and file buttons to import/export your layout.</li>
      <li>Pick a color below the Grid section to define the color of new rooms, or recolor a selected room.</li>
      <li>If you made a mistake or want to redo an action, click redo or undo buttons.</li>
    </ul>
  </div>
  <script type="module" src="./assets/js/main.js" defer></script>
</body>
</html>